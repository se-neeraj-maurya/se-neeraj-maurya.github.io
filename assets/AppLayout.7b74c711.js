import{k as y,u as k,l as S,r as i,o as C,m as A,n as a,p as c,q as s,f as E,s as b,Q as x,t as B,P as N,E as I,v as L}from"./index.c73ad5d1.js";import{u as P}from"./globalStore.da87f570.js";import{u as Q}from"./adminStore.b68fef75.js";import{u as R}from"./cart-store.24769fea.js";import"./axios.boot.7a3cb386.js";const T={key:0,class:"initial-loader"},V=s("div",{class:"loader"},null,-1),$=[V],q={key:1,class:"initial-loader"},O={class:"text-center"},j=s("p",null,"Something went wrong!",-1),K=Object.assign({name:"AppLayout"},{__name:"AppLayout",setup(G){const l=R(),u=Q(),d=y(),p=P(),n=k(),m=S(),o=i(!0),r=i(!1),f=!!localStorage.getItem("access-token"),_=JSON.parse(localStorage.getItem("user"));f||n.replace({name:"login"});const h=async()=>{try{o.value=!0,await u.fetchConfig(),await p.fetchCategory(),await l.fetchCartItem(),w()}catch(e){console.log(e),r.value=!0}finally{o.value=!1}};["app","layout"].includes(m.name)&&n.replace({name:"home"});const v=()=>{window.location.reload(!0)},w=()=>{window.Pusher=N,window.Echo=new I({broadcaster:"pusher",key:"515f854c89b9657065f7",cluster:"ap2",forceTLS:!0});var e=window.Echo.channel("order-notification");e.listen(`.order-event-${_.role}`,function(t){d.notify({progress:!0,type:"positive",position:"top",message:t.title,timeout:1e4})})};return C(()=>{h()}),(e,t)=>{const g=A("router-view");return o.value?(a(),c("div",T,$)):r.value?(a(),c("div",q,[s("div",O,[j,E(x,{outline:"",rounded:"",onClick:t[0]||(t[0]=J=>v())},{default:b(()=>[L(" Try Again! ")]),_:1})])])):(a(),B(g,{key:2}))}}});export{K as default};
