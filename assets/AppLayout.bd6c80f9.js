import{k as g,u as y,l as k,r as n,o as S,m as C,n as a,p as c,q as s,f as E,s as b,Q as x,t as A,P as B,E as N,v as I}from"./index.96042976.js";import{u as L}from"./globalStore.765c6db7.js";import{u as P}from"./adminStore.c11e331e.js";import{u as Q}from"./cart-store.185b6fc4.js";import"./axios.boot.2e5d1b33.js";const R={key:0,class:"initial-loader"},T=s("div",{class:"loader"},null,-1),V=[T],$={key:1,class:"initial-loader"},q={class:"text-center"},O=s("p",null,"Something went wrong!",-1),H=Object.assign({name:"AppLayout"},{__name:"AppLayout",setup(j){const i=Q(),l=P(),u=g(),d=L(),p=y(),m=k(),o=n(!0),r=n(!1);localStorage.getItem("access-token");const f=JSON.parse(localStorage.getItem("user")),_=async()=>{try{o.value=!0,await l.fetchConfig(),await i.fetchCartItem(),await d.fetchCategory(),v()}catch(e){console.log(e),r.value=!0}finally{o.value=!1}};["app","layout"].includes(m.name)&&p.replace({name:"home"});const h=()=>{window.location.reload(!0)},v=()=>{window.Pusher=B,window.Echo=new N({broadcaster:"pusher",key:"515f854c89b9657065f7",cluster:"ap2",forceTLS:!0});var e=window.Echo.channel("order-notification");e.listen(`.order-event-${f.role}`,function(t){u.notify({progress:!0,type:"positive",position:"top",message:t.title,timeout:1e4})})};return S(()=>{_()}),(e,t)=>{const w=C("router-view");return o.value?(a(),c("div",R,V)):r.value?(a(),c("div",$,[s("div",q,[O,E(x,{outline:"",rounded:"",onClick:t[0]||(t[0]=G=>h())},{default:b(()=>[I(" Try Again! ")]),_:1})])])):(a(),A(w,{key:2}))}}});export{H as default};
